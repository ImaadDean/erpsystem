{% extends "base.html" %}

{% block title %}Clients - IDURAR ERP/CRM{% endblock %}
{% block page_title %}Clients{% endblock %}

{% block content %}
<div x-data="clientsApp()" x-init="init()">
    <!-- Loading State -->
    <div x-show="loading" class="flex items-center justify-center py-12">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"></div>
        <span class="ml-3 text-gray-600">Loading clients...</span>
    </div>

    <!-- Error State -->
    <div x-show="error && !loading" class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <i class="fas fa-exclamation-circle text-red-600 mr-2"></i>
                <span class="text-red-800" x-text="error"></span>
            </div>
            <button x-show="error.includes('log in')" @click="showLoginModal = true" class="px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700">
                Login
            </button>
        </div>
    </div>

    <!-- Success State -->
    <div x-show="successMessage"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0 transform translate-y-2"
         x-transition:enter-end="opacity-100 transform translate-y-0"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100 transform translate-y-0"
         x-transition:leave-end="opacity-0 transform translate-y-2"
         class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
        <div class="flex items-center">
            <i class="fas fa-check-circle text-green-600 mr-2"></i>
            <span class="text-green-800" x-text="successMessage"></span>
        </div>
    </div>

    <!-- Header Section -->
    <div x-show="!loading" class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8">
        <div class="mb-4 sm:mb-0">
            <h2 class="text-2xl font-bold text-gray-900 flex items-center">
                <i class="fas fa-users text-primary-600 mr-3"></i>
                Client Management
            </h2>
            <p class="text-gray-600 mt-1">Manage your client relationships and contacts</p>
        </div>
        <div class="flex space-x-3">
            <button @click="exportClients()" class="px-4 py-2 text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                <i class="fas fa-download mr-2"></i>Export
            </button>
            <button @click="showAddClientModal()" class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors duration-200 flex items-center">
                <i class="fas fa-plus mr-2"></i>Add Client
            </button>
        </div>
    </div>

    <!-- Clients Table -->
    <div x-show="!loading" class="bg-white rounded-xl shadow-lg border border-gray-200">
        <!-- Table Header -->
        <div class="px-6 py-4 border-b border-gray-200 flex flex-col sm:flex-row sm:items-center sm:justify-between">
            <h3 class="text-lg font-semibold text-gray-900 flex items-center mb-4 sm:mb-0">
                <i class="fas fa-list text-primary-600 mr-2"></i>
                Client Directory
            </h3>
            <div class="flex items-center space-x-3">
                <div class="relative">
                    <input type="text"
                           x-model="searchTerm"
                           placeholder="Search clients..."
                           class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200 w-64">
                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                </div>
                <button @click="refreshClients()" class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200">
                    <i class="fas fa-refresh"></i>
                </button>
            </div>
        </div>

        <!-- Table Content -->
        <div class="overflow-x-auto">
            <template x-if="filteredClients.length > 0">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Client</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Created</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <template x-for="client in filteredClients" :key="client.id">
                            <tr class="hover:bg-gray-50 transition-colors duration-200">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-10 w-10">
                                            <div class="h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center">
                                                <span class="text-primary-600 font-medium text-sm" x-text="getInitials(client.name)"></span>
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900" x-text="client.name || 'Unknown'"></div>
                                            <div class="text-sm text-gray-500" x-text="'#' + client.id"></div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm text-gray-900 flex items-center">
                                        <i class="fas fa-envelope text-gray-400 mr-2"></i>
                                        <span x-text="client.email || '-'"></span>
                                    </div>
                                    <template x-if="client.phone">
                                        <div class="text-sm text-gray-500 flex items-center mt-1">
                                            <i class="fas fa-phone text-gray-400 mr-2"></i>
                                            <span x-text="client.phone"></span>
                                        </div>
                                    </template>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <template x-if="client.city || client.country">
                                        <div class="text-sm text-gray-900 flex items-center">
                                            <i class="fas fa-map-marker-alt text-gray-400 mr-2"></i>
                                            <span x-text="[client.city, client.country].filter(Boolean).join(', ') || client.address || '-'"></span>
                                        </div>
                                    </template>
                                    <template x-if="!client.city && !client.country && !client.address">
                                        <span class="text-gray-400">-</span>
                                    </template>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    <span x-text="formatDate(client.created_at)"></span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <div class="flex space-x-2">
                                        <button @click="viewClient(client)"
                                               class="text-primary-600 hover:text-primary-900 p-2 hover:bg-primary-50 rounded-lg transition-colors duration-200"
                                               title="View Client">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button @click="editClient(client)"
                                               class="text-yellow-600 hover:text-yellow-900 p-2 hover:bg-yellow-50 rounded-lg transition-colors duration-200"
                                               title="Edit Client">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button @click="deleteClient(client)"
                                                class="text-red-600 hover:text-red-900 p-2 hover:bg-red-50 rounded-lg transition-colors duration-200"
                                                title="Delete Client">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </template>
            <!-- Empty State -->
            <template x-if="filteredClients.length === 0 && !loading">
                <div class="text-center py-16">
                    <div class="mx-auto h-24 w-24 bg-gray-100 rounded-full flex items-center justify-center mb-6">
                        <i class="fas fa-users text-gray-400 text-3xl"></i>
                    </div>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">No clients found</h3>
                    <p class="text-gray-500 mb-6" x-text="searchTerm ? 'No clients match your search criteria.' : 'Get started by adding your first client.'"></p>
                    <button @click="showAddClientModal()"
                           class="inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors duration-200">
                        <i class="fas fa-plus mr-2"></i>Add Client
                    </button>
                </div>
            </template>
        </div>
    </div>

    <!-- Client View/Edit Modal -->
    <div x-show="showClientModal"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         class="fixed inset-0 z-50 overflow-y-auto"
         style="display: none;">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <!-- Background overlay -->
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" @click="closeClientModal()"></div>

            <!-- Modal panel -->
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full">
                <!-- Modal Header -->
                <div class="bg-white px-6 py-4 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-medium text-gray-900 flex items-center">
                            <i class="fas fa-user text-primary-600 mr-2"></i>
                            <span x-text="selectedClient ? (isEditMode ? 'Edit Client' : 'Client Details') : 'Add New Client'"></span>
                        </h3>
                        <button @click="closeClientModal()" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>

                <!-- Modal Body -->
                <div class="bg-white px-6 py-4">
                    <template x-if="selectedClient || !selectedClient">
                        <div>
                            <!-- View Mode -->
                            <template x-if="selectedClient && !isEditMode">
                                <div class="space-y-6">
                                    <!-- Client Avatar and Basic Info -->
                                    <div class="flex items-center space-x-4">
                                        <div class="h-16 w-16 rounded-full bg-primary-100 flex items-center justify-center">
                                            <span class="text-primary-600 font-bold text-xl" x-text="getInitials(selectedClient.name)"></span>
                                        </div>
                                        <div>
                                            <h4 class="text-xl font-semibold text-gray-900" x-text="selectedClient.name"></h4>
                                            <p class="text-gray-500" x-text="'Client ID: #' + selectedClient.id"></p>
                                        </div>
                                    </div>

                                    <!-- Contact Information -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                            <div class="flex items-center text-gray-900">
                                                <i class="fas fa-envelope text-gray-400 mr-2"></i>
                                                <span x-text="selectedClient.email || 'Not provided'"></span>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                            <div class="flex items-center text-gray-900">
                                                <i class="fas fa-phone text-gray-400 mr-2"></i>
                                                <span x-text="selectedClient.phone || 'Not provided'"></span>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">City</label>
                                            <div class="flex items-center text-gray-900">
                                                <i class="fas fa-map-marker-alt text-gray-400 mr-2"></i>
                                                <span x-text="selectedClient.city || 'Not provided'"></span>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Country</label>
                                            <div class="flex items-center text-gray-900">
                                                <i class="fas fa-globe text-gray-400 mr-2"></i>
                                                <span x-text="selectedClient.country || 'Not provided'"></span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Address -->
                                    <template x-if="selectedClient.address">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                                            <div class="flex items-start text-gray-900">
                                                <i class="fas fa-map-marker-alt text-gray-400 mr-2 mt-1"></i>
                                                <span x-text="selectedClient.address"></span>
                                            </div>
                                        </div>
                                    </template>

                                    <!-- Notes -->
                                    <template x-if="selectedClient.notes">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
                                            <div class="bg-gray-50 rounded-lg p-3">
                                                <span x-text="selectedClient.notes"></span>
                                            </div>
                                        </div>
                                    </template>

                                    <!-- Timestamps -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-gray-200">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Created</label>
                                            <span class="text-gray-900" x-text="formatDate(selectedClient.created_at)"></span>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Last Updated</label>
                                            <span class="text-gray-900" x-text="formatDate(selectedClient.updated_at)"></span>
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <!-- Edit Mode -->
                            <template x-if="isEditMode">
                                <form @submit.prevent="saveClient()" class="space-y-6">
                                    <!-- Basic Information -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Name *</label>
                                            <input type="text"
                                                   x-model="editForm.name"
                                                   required
                                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Email *</label>
                                            <input type="email"
                                                   x-model="editForm.email"
                                                   required
                                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                            <input type="tel"
                                                   x-model="editForm.phone"
                                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">City</label>
                                            <input type="text"
                                                   x-model="editForm.city"
                                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Country</label>
                                            <input type="text"
                                                   x-model="editForm.country"
                                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">State</label>
                                            <input type="text"
                                                   x-model="editForm.state"
                                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                                        </div>
                                    </div>

                                    <!-- Address -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                                        <textarea x-model="editForm.address"
                                                 rows="3"
                                                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"></textarea>
                                    </div>

                                    <!-- Notes -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
                                        <textarea x-model="editForm.notes"
                                                 rows="3"
                                                 placeholder="Add any additional notes about this client..."
                                                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"></textarea>
                                    </div>
                                </form>
                            </template>
                        </div>
                    </template>
                </div>

                <!-- Modal Footer -->
                <div class="bg-gray-50 px-6 py-3 flex justify-end space-x-3">
                    <button @click="closeClientModal()"
                           class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                        Cancel
                    </button>
                    <template x-if="selectedClient && !isEditMode">
                        <button @click="isEditMode = true; editForm = { ...selectedClient }"
                               class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors duration-200">
                            <i class="fas fa-edit mr-2"></i>Edit Client
                        </button>
                    </template>
                    <template x-if="isEditMode">
                        <div class="flex space-x-3">
                            <button @click="selectedClient ? (isEditMode = false) : closeClientModal()"
                                   type="button"
                                   class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                                <span x-text="selectedClient ? 'Cancel Edit' : 'Cancel'"></span>
                            </button>
                            <button @click="saveClient()"
                                   :disabled="saving"
                                   class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 disabled:opacity-50">
                                <i class="fas fa-save mr-2"></i>
                                <span x-text="saving ? 'Saving...' : (selectedClient ? 'Save Changes' : 'Add Client')"></span>
                            </button>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function clientsApp() {
    return {
        // State
        loading: true,
        error: null,
        clients: [],
        searchTerm: '',
        showCreateModal: false,
        showClientModal: false,
        selectedClient: null,
        isEditMode: false,
        saving: false,
        editForm: {},
        successMessage: null,

        // Computed properties
        get filteredClients() {
            if (!this.searchTerm) return this.clients;

            return this.clients.filter(client => {
                const searchLower = this.searchTerm.toLowerCase();
                return (
                    (client.name && client.name.toLowerCase().includes(searchLower)) ||
                    (client.email && client.email.toLowerCase().includes(searchLower)) ||
                    (client.city && client.city.toLowerCase().includes(searchLower)) ||
                    (client.country && client.country.toLowerCase().includes(searchLower)) ||
                    (client.phone && client.phone.toLowerCase().includes(searchLower)) ||
                    client.id.toString().includes(searchLower)
                );
            });
        },

        // Methods
        async init() {
            await this.fetchClients();
        },

        async fetchClients() {
            try {
                this.loading = true;
                this.error = null;

                const response = await fetch('/clients', {
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                // Handle the new JSON structure
                if (data.success && data.result) {
                    this.clients = data.result;
                } else {
                    this.clients = [];
                }

            } catch (error) {
                console.error('Error fetching clients:', error);
                this.error = 'Failed to load clients. Please try again.';
            } finally {
                this.loading = false;
            }
        },

        async refreshClients() {
            await this.fetchClients();
        },

        // Client modal methods
        viewClient(client) {
            this.selectedClient = client;
            this.isEditMode = false;
            this.showClientModal = true;
        },

        editClient(client) {
            this.selectedClient = { ...client }; // Create a copy to avoid reference issues
            this.isEditMode = true;
            this.editForm = { ...client }; // Copy client data to edit form
            this.showClientModal = true;
        },

        // Add client modal methods
        showAddClientModal() {
            this.selectedClient = null;
            this.isEditMode = true;
            this.editForm = {
                name: '',
                email: '',
                phone: '',
                city: '',
                country: '',
                state: '',
                address: '',
                notes: ''
            };
            this.showClientModal = true;
        },

        closeClientModal() {
            this.showClientModal = false;
            this.selectedClient = null;
            this.isEditMode = false;
            this.editForm = {};
        },

        async saveClient() {
            try {
                this.saving = true;
                this.error = null;

                if (this.selectedClient) {
                    // Edit existing client - make API call
                    const response = await fetch(`/api/v1/dashboard/customers/${this.selectedClient.id}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(this.editForm)
                    });

                    const result = await response.json();

                    if (result.success) {
                        // Update local data with server response
                        const clientIndex = this.clients.findIndex(c => c.id === this.selectedClient.id);
                        if (clientIndex !== -1) {
                            this.clients[clientIndex] = result.data;
                            this.selectedClient = result.data;
                        }
                        this.isEditMode = false;
                        console.log('Client updated successfully in database');

                        // Show success message (you can implement a toast notification)
                        this.showSuccessMessage('Client updated successfully!');
                    } else {
                        throw new Error(result.message || 'Failed to update client');
                    }
                } else {
                    // Add new client - make API call
                    const response = await fetch('/api/v1/dashboard/customers', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(this.editForm)
                    });

                    const result = await response.json();

                    if (result.success) {
                        // Add to local data
                        this.clients.unshift(result.data);
                        this.closeClientModal();
                        console.log('Client added successfully to database');

                        // Show success message
                        this.showSuccessMessage('Client added successfully!');
                    } else {
                        throw new Error(result.message || 'Failed to add client');
                    }
                }

            } catch (error) {
                console.error('Error saving client:', error);
                this.error = `Error saving client: ${error.message}`;
            } finally {
                this.saving = false;
            }
        },

        async deleteClient(client) {
            if (confirm(`Are you sure you want to delete ${client.name}?`)) {
                try {
                    const response = await fetch(`/api/v1/dashboard/customers/${client.id}`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    const result = await response.json();

                    if (result.success) {
                        // Remove from local array
                        this.clients = this.clients.filter(c => c.id !== client.id);
                        console.log('Client deleted successfully from database');
                        this.showSuccessMessage('Client deleted successfully!');
                    } else {
                        throw new Error(result.message || 'Failed to delete client');
                    }
                } catch (error) {
                    console.error('Error deleting client:', error);
                    this.error = `Error deleting client: ${error.message}`;
                }
            }
        },

        exportClients() {
            // Export functionality
            console.log('Exporting clients...');
        },

        showSuccessMessage(message) {
            this.successMessage = message;
            setTimeout(() => {
                this.successMessage = null;
            }, 3000); // Hide after 3 seconds
        },

        getInitials(name) {
            if (!name) return 'U';
            return name.charAt(0).toUpperCase();
        },

        formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        },

        viewCustomer(customer) {
            console.log('View customer:', customer);
            this.showNotification('View customer functionality coming soon', 'info');
        },

        editCustomer(customer) {
            console.log('Edit customer:', customer);
            this.showNotification('Edit customer functionality coming soon', 'info');
        },

        async deleteCustomer(customer) {
            if (!confirm(`Are you sure you want to delete customer "${customer.name}"? This action cannot be undone.`)) {
                return;
            }

            try {
                const response = await fetch(`/api/v1/customers/${customer.id}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${this.authToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    this.customers = this.customers.filter(c => c.id !== customer.id);
                    this.showNotification('Customer deleted successfully', 'success');
                } else {
                    throw new Error('Failed to delete customer');
                }
            } catch (error) {
                console.error('Error deleting customer:', error);
                this.showNotification('Error deleting customer', 'error');
            }
        },

        exportCustomers() {
            console.log('Export customers');
            this.showNotification('Export functionality coming soon', 'info');
        },

        showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transition-all duration-300 ${
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'error' ? 'bg-red-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    }
}
</script>
{% endblock %}
